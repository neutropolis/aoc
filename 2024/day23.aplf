 (p1 p2)←day23 input
 i←'-'(≠⊆⊢)¨⊃⎕NGET input 1
 t←⍸'t'=⊃¨u←(⊂∘⍋⌷⊢)∪⊃,/i ⋄ i←i[⍋i←↑u∘⍳¨i;]
 a←1@((⌽¨,⊢)↓i)⊢0⍴⍨2⍴≢u
 tri←∪(⊂∘⍋⌷⊢)¨⊃,/(⍳≢u){⊂⍺,¨(</¨x)/x←p[⍸a[p←∘.,⍨⍸⍵]]}⍤0 1⊢a
 p1←+/{∨/⍵∊t}¨tri
 b←1@(2⍴¨⍳≢a)⊢a
 p2←⊃{⍺,',',⍵}/u⌷⍨⊂⍸(⊢=⌈/)+/2=b+.≠b
