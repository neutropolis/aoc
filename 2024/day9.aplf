 (p1 p2)←day9 input
 i←⍎¨¯1↓⊃⎕NGET input
 ix←⍸(×≢)¨g←(1+0,i⌷⍨⊂⍸~x)⊂i⌷⍨⊂⍸x←1 0⍴⍨≢i
 e←(((¯1+⍳≢ix)@ix)g)/⍨¨g
 s←(-c)↓∊(((c←+/~×∘≢¨e)↑⌽∊e)@(⍸~×∘≢¨e))e
 p1←'I13'⎕FMT s+.×¯1+⍳≢s
 Alloc←{
     ~×⍺:⍵
     a←⍸∨/¨⍺=⍵
     (~×≢p←⍸(1⍴⍨≢v)⍷~×∘≢¨⍵)∨(~×≢v←a⊃⍵):⍵∇⍨⍺-1
     a<⊃p:⍵∇⍨⍺-1
     w←(v@((⊃p)+¯1+⍳≢v))⍵
     w←((a-1)↑w),(0∘⍴¨a⊃w),(a↓w)
     w∇⍨⍺-1
 }
 s0←(⌈/∊e)Alloc e
 s←∊(0@(⍸~(×≢)¨s0))s0
 p2←'I13'⎕FMT s+.×¯1+⍳≢s
