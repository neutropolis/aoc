 (p1 p2)←day18 input
 i←⌽1+↑⍎¨⊃⎕NGET input 1
 m←71 71⍴'.'
 m←1@(⊂1 1)⊢'#'@(↓1024↑i)⊢m
 N←{
     c←(⊂2 2)⊃⍵
     c≢'.':c
     ngh←(9⍴0 1)/,⍵
     ngh/⍨←~ngh∊'.' '#' 0
     ×≢ngh:1+⌊/ngh ⋄ c
 }
 p1←¯1+(⊂71 71)⊃(N⌺3 3)⍣{'.'≢(⊂71 71)⊃⍵}⊢m

 F←{
     d←⊂⍴m←1@(⊂1 1)⊢'#'@(↓⍺↑i)⊢⍵
     '.'≡d⊃(N⌺3 3)⍣≡⊢m
 }
 Bin←{
     =/⍵:⊃⍵
     (s e)←⍵
     ⍺⍺ b←s+⌊2÷⍨e-s:⍺⍺ ∇∇ s b ⋄ ⍺⍺ ∇∇ (b+1) e
 }
 p2←⊃{(⍕⍺),',',⍕⍵}/¯1+⌽i[(F∘(71 71⍴'.')) Bin 1 (≢i);]
